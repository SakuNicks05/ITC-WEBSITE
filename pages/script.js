const content = {
    pop: [
        {cover: "../assets/album-images/pop/billie.jpg",
        title: "Billie Jean",
        artist: "Michael Jackson",
        album: "Thriller",
        audio: "../assets/audio/pop/billie.mp3"},

        {cover: "../assets/album-images/pop/prayer.jpg",
        title: "Like a Prayer",
        artist: "Madonna",
        album: "Like a Prayer",
        audio: "../assets/audio/pop/prayer.mp3"},

        {cover: "../assets/album-images/pop/whitney.jpg",
        title: "I Will Always Love You",
        artist: "Whitney Houston",
        album: "The Bodyguard",
        audio: "../assets/audio/pop/will-love.mp3"},

        {cover: "../assets/album-images/pop/purple.jpg",
        title: "Purple Rain",
        artist: "Prince",
        album: "Purple Rain",
        audio: "../assets/audio/pop/purple.mp3"},

        {cover: "../assets/album-images/pop/brit.jpg",
        title: "...Baby One Last Time",
        artist: "Britney Spears",
        album: "...Baby One More Time",
        audio: "../assets/audio/pop/baby-one.mp3"},

        {cover: "../assets/album-images/pop/borap.jpg",
        title: "Bohemian Rhapsody",
        artist: "Queen",
        album: "A Night at the Opera",
        audio: "../assets/audio/pop/borap.mp3"},

        {cover: "../assets/album-images/pop/dancing.jpg",
        title: "Dancing Queen",
        artist: "ABBA",
        album: "Arrival",
        audio: "../assets/audio/pop/dancing.mp3"},

        {cover: "../assets/album-images/pop/dreams.png",
        title: "Dreams",
        artist: "Fleetwood Mac",
        album: "Rumours",
        audio: "../assets/audio/pop/dreams.mp3"},

        {cover: "../assets/album-images/pop/happy.jpg",
        title: "Happy",
        artist: "Pharrell Williams",
        album: "Girl",
        audio: "../assets/audio/pop/happy.mp3"},

        {cover: "../assets/album-images/pop/journey.jpg",
        title: "Don't Stop Believin'",
        artist: "Journey",
        album: "Escape",
        audio: "../assets/audio/pop/believe.mp3"},

        {cover: "../assets/album-images/pop/shake.jpg",
        title: "Shake It Off",
        artist: "Taylor Swift",
        album: "1989",
        audio: "../assets/audio/pop/shake.mp3"},

        {cover: "../assets/album-images/pop/single.png",
        title: "Single Ladies (Put a Ring on It)",
        artist: "Beyoncé",
        album: "I Am… Sasha Fierce",
        audio: "../assets/audio/pop/single.mp3"},

        {cover: "../assets/album-images/pop/toxic.png",
        title: "Toxic",
        artist: "Britney Spears",
        album: "In the Zone",
        audio: "../assets/audio/pop/toxic.mp3"},

        {cover: "../assets/album-images/pop/wonder.jpg",
        title: "Wonderwall",
        artist: "Oasis",
        album: "(What’s the Story) Morning Glory?",
        audio: "../assets/audio/pop/wonderwall.mp3"},

        {cover: "../assets/album-images/pop/bright.jpg",
        title: "Mr. Brightside",
        artist: "The Killers",
        album: "Hot Fuss",
        audio: "../assets/audio/pop/brightside.mp3"}
    ],

    rock: [
        {cover: "../assets/album-images/pop/rock/stair.jpg",
        title: "Stairway to Heaven",
        artist: "Led Zeppelin",
        album: "Led Zeppelin IV",
        audio: "../assets/audio/rock/stair.mp3"},

        {cover: "../assets/album-images/pop/rock/living.jpg",
        title: "Livin' on a Prayer",
        artist: "Bon Jovi",
        album: "Slippery When Wet (1986)",
        audio: "../assets/audio/rock/living.mp3"},

        {cover: "../assets/album-images/pop/rock/summer-69.jpg",
        title: "Summer of '69",
        artist: "Bryan Adams",
        album: "Reckless (1984)",
        audio: "../assets/audio/rock/summer.mp3"},

        {cover: "../assets/album-images/pop/rock/let-be.png",
        title: "Let It Be",
        artist: "The Beatles",
        album: "Let It Be",
        audio: "../assets/audio/rock/let-be.mp3"},

        {cover: "../assets/album-images/pop/rock/hotel.jpg",
        title: "Hotel California",
        artist: "Eagles",
        album: "Hotel California",
        audio: "../assets/audio/rock/hotel.mp3"},

        {cover: "../assets/album-images/pop/rock/paint.jpg",
        title: "Paint It Black",
        artist: "The Rolling Stones",
        album: "Aftermath",
        audio: "../assets/audio/rock/paint.mp3"},

        {cover: "../assets/album-images/pop/rock/imagine.jpg",
        title: "Imagine",
        artist: "John Lennon",
        album: "Imagine ",
        audio: "../assets/audio/rock/imagine.mp3"},

        {cover: "../assets/album-images/pop/rock/sweet-child.jpg",
        title: "Sweet Child O’ Mine",
        artist: "Guns N’ Roses",
        album: "Appetite for Destruction",
        audio: "../assets/audio/rock/sweet.mp3"},

        {cover: "../assets/album-images/pop/rock/teen.jpg",
        title: "Smells Like Teen Spirit",
        artist: "Nirvana",
        album: "Nevermind",
        audio: "../assets/audio/rock/teen.mp3"},

        {cover: "../assets/album-images/pop/rock/numb.jpg",
        title: "Comfortably Numb'",
        artist: "Pink Floyd",
        album: "The Wall",
        audio: "../assets/audio/rock/numb.mp3"},

        {cover: "../assets/album-images/pop/rock/born-run.jpg",
        title: "Born to Run",
        artist: "Bruce Springsteen",
        album: "Born to Run",
        audio: "../assets/audio/rock/born.mp3"},

        {cover: "../assets/album-images/pop/rock/purple.jpg",
        title: "Purple Haze",
        artist: "Jimi Hendrix",
        album: "Are You Experienced",
        audio: "../assets/audio/rock/haze.mp3"},

        {cover: "../assets/album-images/pop/rock/free-fallin.jpg",
        title: "Free Fallin",
        artist: "Tom Petty",
        album: "Full Moon Fever",
        audio: "../assets/audio/rock/free.mp3"},

        {cover: "../assets/album-images/pop/rock/black.jpg",
        title: "Back in Black",
        artist: "AC/DC",
        album: "Back in Black",
        audio: "../assets/audio/rock/black.mp3"},

        {cover: "../assets/album-images/pop/rock/dream-on.jpg",
        title: "Dream On",
        artist: "Aerosmith",
        album: "Aerosmith",
        audio: "../assets/audio/rock/dream.mp3"}
    ],

    classical: [
        {cover: "../assets/album-images/pop/classical/symph5.jpg",
        title: "Symphony No. 5 (I)",
        artist: "Beethoven",
        album: "Symphony No. 5",
        audio: "../assets/audio/classical/sym5.mp3"},

        {cover: "../assets/album-images/pop/classical/clair.jpg",
        title: "Clair de Lune",
        artist: "Debussy",
        album: "Suite bergamasque",
        audio: "../assets/audio/classical/clair.mp3"},

        {cover: "../assets/album-images/pop/classical/canon.jpg",
        title: "Canon in D",
        artist: "Pachelbel ",
        album: "Canon and Gigue",
        audio: "../assets/audio/classical/canon.mp3"},

        {cover: "../assets/album-images/pop/classical/season.jpg",
        title: "The Four Seasons: Spring",
        artist: "Vivaldi",
        album: "The Four Seasons",
        audio: "../assets/audio/classical/four.mp3"},

        {cover: "../assets/album-images/pop/classical/kleine.jpg",
        title: "Eine kleine Nachtmusik",
        artist: "Mozart",
        album: "Serenade No. 13",
        audio: "../assets/audio/classical/kleine.mp3"},

        {cover: "../assets/album-images/pop/classical/moonlight.jpg",
        title: "Moonlight Sonata (I)",
        artist: "Beethoven",
        album: "Piano Sonata No. 14",
        audio: "../assets/audio/classical/moon.mp3"},

        {cover: "../assets/album-images/pop/classical/ave.jpg",
        title: "Ave Maria",
        artist: "Schubert",
        album: "Ellens dritter Gesang",
        audio: "../assets/audio/classical/ave.mp3"},

        {cover: "../assets/album-images/pop/classical/swan.jpg",
        title: "Swan Lake (Theme)",
        artist: "Tchaikovsky",
        album: "Swan Lake",
        audio: "../assets/audio/classical/swan.mp3"},

        {cover: "../assets/album-images/pop/classical/ride.jpg",
        title: "Ride of the Valkyries",
        artist: "Wagner",
        album: "Die Walküre",
        audio: "../assets/audio/classical/ride.mp3"},

        {cover: "../assets/album-images/pop/classical/bolero.jpg",
        title: "Boléro",
        artist: "Ravel",
        album: "Boléro",
        audio: "../assets/audio/classical/bolero.mp3"},

        {cover: "../assets/album-images/pop/classical/gym.jpg",
        title: "Gymnopédie No. 1",
        artist: "Erik Satie",
        album: "Gymnopédies",
        audio: "../assets/audio/classical/gym.mp3"},

        {cover: "../assets/album-images/pop/classical/braden.jpg",
        title: "Brandenburg Concerto No. 3",
        artist: "Bach",
        album: "Brandenburg Concertos",
        audio: "../assets/audio/classical/braden3.mp3"},

        {cover: "../assets/album-images/pop/classical/air.jpg",
        title: "Air on the G String",
        artist: "Bach",
        album: "Orchestral Suite No. 3",
        audio: "../assets/audio/classical/airg.mp3"},

        {cover: "../assets/album-images/pop/classical/peer.jpg",
        title: "Peer Gynt: Morning Mood",
        artist: "Grieg",
        album: "Peer Gynt Suite",
        audio: "../assets/audio/classical/morning.mp3"},

        {cover: "../assets/album-images/pop/classical/adagio.jpg",
        title: "Adagio for Strings",
        artist: "Samuel Barber",
        album: "Adagio for Strings",
        audio: "../assets/audio/classical/adagio.mp3"}
    ],

    jazz: [
        {cover: "../assets/album-images/pop/jazz/five.jpg",
        title: "Take Five",
        artist: "The Dave Brubeck Quartet",
        album: "Time Out",
        audio: "../assets/audio/jazz/five.mp3"},

        {cover: "../assets/album-images/pop/jazz/so-what.jpg",
        title: "So What",
        artist: "Miles Davis",
        album: "Kind of Blue",
        audio: "../assets/audio/jazz/so-what.mp3"},

        {cover: "../assets/album-images/pop/jazz/fav.jpg",
        title: "My Favorite Things",
        artist: "John Coltrane",
        album: "My Favorite Things",
        audio: "../assets/audio/jazz/fav.mp3"},

        {cover: "../assets/album-images/pop/jazz/wonderful.jpg",
        title: "What a Wonderful World",
        artist: "Louis Armstrong",
        album: "What a Wonderful World",
        audio: "../assets/audio/jazz/wonderful.mp3"},

        {cover: "../assets/album-images/pop/jazz/moon.jpg",
        title: "Fly Me to the Moon",
        artist: "Frank Sinatra",
        album: "It Might as Well Be Swing",
        audio: "../assets/audio/jazz/fly.mp3"},

        {cover: "../assets/album-images/pop/jazz/all-billie.jpg",
        title: "All of Me",
        artist: "Billie Holiday",
        album: "Billie Holiday Sings",
        audio: "../assets/audio/jazz/all.mp3"},

        {cover: "../assets/album-images/pop/jazz/summertime.jpg",
        title: "Summertime",
        artist: "Ella Fitzgerald & Louis Armstrong",
        album: "Porgy and Bess",
        audio: "../assets/audio/jazz/summertime.mp3"},

        {cover: "../assets/album-images/pop/jazz/autumn.jpg",
        title: "Autumn Leaves",
        artist: "Cannonball Adderley",
        album: "Somethin’ Else",
        audio: "../assets/audio/jazz/autumn.mp3"},

        {cover: "../assets/album-images/pop/jazz/round.jpg",
        title: "Round Midnight",
        artist: "Thelonious Monk",
        album: "'Round Midnight",
        audio: "../assets/audio/jazz/round.mp3"},

        {cover: "../assets/album-images/pop/jazz/feeling.png",
        title: "Feeling Good",
        artist: "Nina Simone",
        album: "I Put a Spell on You",
        audio: "../assets/audio/jazz/feeling-good.mp3"},

        {cover: "../assets/album-images/pop/jazz/love-supreme.jpg",
        title: "A Love Supreme, Pt. I: Acknowledgement",
        artist: "John Coltrane",
        album: "A Love Supreme",
        audio: "../assets/audio/jazz/love.mp3"},
 
        {cover: "../assets/album-images/pop/jazz/bluegreen.jpg",
        title: "Blue in Green",
        artist: "Miles Davis",
        album: "Kind of Blue",
        audio: "../assets/audio/jazz/blue.mp3"},

        {cover: "../assets/album-images/pop/jazz/sentimental.jpg",
        title: "In a Sentimental Mood",
        artist: "Duke Ellington & John Coltrane",
        album: "Duke Ellington & John Coltrane",
        audio: "../assets/audio/jazz/sentiment.mp3"},

        {cover: "../assets/album-images/pop/jazz/strange.jpg",
        title: "Strange Fruit",
        artist: "Billie Holiday",
        album: "Commodore Recordings",
        audio: "../assets/audio/jazz/strange.mp3"},

        {cover: "../assets/album-images/pop/jazz/misty.jpg",
        title: "Misty",
        artist: "Erroll Garner",
        album: "Concert by the Sea",
        audio: "../assets/audio/jazz/misty.mp3"}
    ],

    indie: [
        {cover: "../assets/album-images/pop/indie/rep.jpg",
        title: "Reptilia",
        artist: "The Strokes",
        album: "Room on Fire",
        audio: "../assets/audio/indie/rep.mp3"},

        {cover: "../assets/album-images/pop/indie/take.jpg",
        title: "Take Me Out",
        artist: "Franz Ferdinand",
        album: "Franz Ferdinand",
        audio: "../assets/audio/indie/take-out.mp3"},

        {cover: "../assets/album-images/pop/indie/arctic.png",
        title: "Do I Wanna Know?",
        artist: "Arctic Monkeys",
        album: "AM",
        audio: "../assets/audio/indie/wanna-know.mp3"},

        {cover: "../assets/album-images/pop/indie/no-car.jpg",
        title: "No Cars Go",
        artist: "Arcade Fire",
        album: "Neon Bible",
        audio: "../assets/audio/indie/no-car.mp3"},

        {cover: "../assets/album-images/pop/indie/kids.jpg",
        title: "Kids",
        artist: "MGMT",
        album: "Oracular Spectacular",
        audio: "../assets/audio/pop/indie/kids.mp3"},

        {cover: "../assets/album-images/pop/indie/phoenix.jpg",
        title: "Lisztomania",
        artist: "Phoenix",
        album: "Wolfgang Amadeus Phoenix",
        audio: "../assets/audio/indie/phoenix.mp3"},

        {cover: "../assets/album-images/pop/indie/height.jpg",
        title: "Such Great Heights",
        artist: "The Postal Service",
        album: "Give Up",
        audio: "../assets/audio/indie/height.mp3"},

        {cover: "../assets/album-images/pop/indie/ho.png",
        title: "Ho Hey",
        artist: "The Lumineers",
        album: "The Lumineers",
        audio: "../assets/audio/indie/ho.mp3"},

        {cover: "../assets/album-images/pop/indie/electric.jpg",
        title: "Electric Feel",
        artist: "MGMT",
        album: "Oracular Spectacular",
        audio: "../assets/audio/indie/electric.mp3"},

        {cover: "../assets/album-images/pop/indie/skin.jpg",
        title: "Skinny Love",
        artist: "Bon Iver",
        album: "For Emma, Forever Ago",
        audio: "../assets/audio/indie/skin.mp3"},

        {cover: "../assets/album-images/pop/indie/oxford.jpg",
        title: "Oxford Comma",
        artist: "Vampire Weekend",
        album: "Vampire Weekend",
        audio: "../assets/audio/indie/oxford.mp3"},

        {cover: "../assets/album-images/pop/indie/1901.png",
        title: "1901",
        artist: "Phoenix",
        album: "Wolfgang Amadeus Phoenix",
        audio: "../assets/audio/indie/1901.mp3"},

        {cover: "../assets/album-images/pop/indie/mine.jpg",
        title: "R U Mine?",
        artist: "Arctic Monkeys",
        album: "AM",
        audio: "../assets/audio/indie/mine.mp3"},

        {cover: "../assets/album-images/pop/indie/middle.jpg",
        title: "The Middle",
        artist: "Jimmy Eat World",
        album: "Bleed American",
        audio: "../assets/audio/indie/middle.mp3"},

        {cover: "../assets/album-images/pop/indie/unsat.jpg",
        title: "Unsatisfied",
        artist: "The Replacements",
        album: "Let It Be",
        audio: "../assets/audio/indie/unsat.mp3"}
    ]
};

// UPON LOADING

document.addEventListener("DOMContentLoaded", () => {
    renderSongs("pop");
});

let links = document.querySelectorAll(".navbar-list a");

// WITH EVERY CLICK PER CATEGORY -- LEARNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN

for(let i = 0; i < links.length; i++) {
    links[i].addEventListener("click", function (e){
        e.preventDefault();
        renderSongs(this.dataset.section);
    });
}

// VARIABLES

const songOrders = document.getElementById("song-container");
const songTemplate = document.getElementById("song-template");
const audio = document.getElementById("audio-player");

let currentButton = null;
let currentSong = null;
let cardPlayButton = document.getElementById("card-play-button");
let currentSongs = [];
let currentIndex = -1;

// RENDERS SONGS FOR EVERY CLICK

function renderSongs(section) {
    songOrders.innerHTML = "";
    currentSongs = content[section];

    for(let i = 0; i < content[section].length; i++) {
        let song = content[section][i];
        const listSong = songTemplate.content.cloneNode(true);

        document.getElementById("current-section").textContent = section;
        listSong.querySelector(".cover").src = song.cover;
        listSong.querySelector(".title").textContent = song.title;
        listSong.querySelector(".artist").textContent = song.artist;
        listSong.querySelector(".album").textContent = song.album;
        
        const durationElement = listSong.querySelector(".duration");
        const tempAudio = new Audio(song.audio);

        // DURATION COMPUTATION

        tempAudio.addEventListener("loadedmetadata", function() {
            const min = Math.floor(tempAudio.duration / 60);
            const sec = Math.floor(tempAudio.duration % 60).toString().padStart(2, "0");

            durationElement.textContent = `${min}:${sec}`;
        });

        // ASSIGNS BUTTON WITH SONG

        let playBtn = listSong.querySelector(".play");
        playBtn.dataset.audio = song.audio;
        playBtn.addEventListener("click", function() {
            currentIndex = i;
            playSong(song, playBtn);
        });

        // ADDS TO THE LIST OF CURRENT SONGS

        songOrders.appendChild(listSong);

        // CURRENT SONG PLAYING

        if(currentSong && song.audio === currentSong.audio) {
            playBtn.src = "../assets/icons/pause.png";
            currentButton = playBtn;
            cardPlayButton.src = "../assets/icons/pause.png";
        }
    }
}

// FORWARD OR PREV BUTTONS

const prevButton = document.getElementById("prev-button");
const nextButton = document.getElementById("next-button");

// PREV BUTTONS

prevButton.addEventListener("click", function() {
    if(currentSongs.length === 0) {
        return;
    }
    currentIndex = (currentIndex - 1 + currentSongs.length) % currentSongs.length;
    const prev = currentSongs[currentIndex];
    const btn = findButtonBySong(prev.audio);
    playSong(prev, btn);
});

// FORWARD BUTTONS

nextButton.addEventListener("click", function() {
    if(currentSongs.length === 0) {
        return;
    }
    currentIndex = (currentIndex + 1) % currentSongs.length;
    const next = currentSongs[currentIndex];
    const btn = findButtonBySong(next.audio);
    playSong(next, btn);
});


// FINDING BUTTONS PER SONG 

function findButtonBySong(audioUrl) {
    const buttons = document.querySelectorAll(".play");
    for(let i = 0; i < buttons.length; i++) {
        if(buttons[i].dataset.audio === audioUrl) {
            return buttons[i];
        }
    }
    return null;
}

// HANDLER FOR CARD PLAY BUTTON

cardPlayButton.addEventListener("click", function() {
    if(!currentSong) return;
    playSong(currentSong, currentButton);
});

// FUNCTION FOR PLAYING SONGS

function playSong(song, button) {
    const songURL = new URL(song.audio, location.href).href;
    let indexInPlaylist = -1;

    // RE-ASSIGNING INDEX

    for(let i = 0; i < currentSongs.length; i++) {
        if(currentSongs[i].audio === song.audio){
            indexInPlaylist = i;
            break;
        }
    }

    // RE-ASSIGNING INDEX

    if (indexInPlaylist !== -1) {
        currentIndex = indexInPlaylist;
    }

    // PLAY/PAUSE CHECKER

    if(audio.src !== songURL) {
        
        // RESETS BAR
        bar.value = 0;

        if(currentButton) {
            currentButton.src = "../assets/icons/play.png";
        }

        if(currentSong && currentSong !== song) {
            cardPlayButton.src = "../assets/icons/play.png";
        }

        audio.src = song.audio;
        audio.play();

        if(button){
            button.src = "../assets/icons/pause.png";
        }
        cardPlayButton.src = "../assets/icons/pause.png";

        currentButton = button || currentButton;
        currentSong = song;

        updateSongPlaying(song);
        return;
    }

    // SWITCHING THE ICONS DEPENDING ON IF SONG IS PAUSED/PLAYED

    if(audio.paused) {
        audio.play();
        if(button) {
            button.src = "../assets/icons/pause.png";
        }
        cardPlayButton.src = "../assets/icons/pause.png";
    } else {
        audio.pause();
        if(button) {
            button.src = "../assets/icons/play.png";
        }
        cardPlayButton.src = "../assets/icons/play.png";
    }
}

// UPDATING SONG CARD INFO 

function updateSongPlaying(song) {
    document.getElementById("album-image").src = song.cover;
    document.getElementById("card-title").textContent = song.title;
    document.getElementById("card-artist").textContent = song.artist;
    document.getElementById("card-song-album").textContent = song.album;
    document.getElementById("full-duration").textContent = song.duration;
}

// TIMESTAMP COUNTER

audio.addEventListener("timeupdate", function() {
    if(!audio.duration) {
        return;
    }
    let min = Math.floor(audio.currentTime / 60);
    let sec = Math.floor(audio.currentTime % 60).toString().padStart(2, "0");

    // UPDATING TIMESTAMP
    document.getElementById("time-now").textContent = `${min}:${sec}`;

    bar.value = (audio.currentTime / audio.duration) * 100;
});

// DURATION COMPUTING FOR CURRENT SONG PLAYING

audio.addEventListener("loadedmetadata", function() {
    const min = Math.floor(audio.duration / 60);
    const sec = Math.floor(audio.duration % 60).toString().padStart(2, "0");

    document.getElementById("full-duration").textContent = `${min}:${sec}`;
});

// RE-SETS ICON IF SONG ENDS

audio.addEventListener("ended", function() {
    if(currentSongs.length === 0) {
        return;
    }

    currentIndex = (currentIndex + 1) % currentSongs.length;
    const next = currentSongs[currentIndex];
    const btn = findButtonBySong(next.audio);
    playSong(next, btn);
});

// TIMESTAMP SEEKING

const bar = document.getElementById("bar");

bar.addEventListener("input", function() {
    if(!audio.duration) return;
    audio.currentTime = (bar.value / 100) * audio.duration;
});

// DARK MODE STYLING

const modeButton = document.getElementById("mode");
const cardElement = document.getElementById("card-cont");
const backgroundMode = document.getElementById("grad-1");

function darkMode() {
    document.body.classList.toggle("dark");
    backgroundMode.classList.toggle("set-background");
    modeButton.classList.toggle("set-button");
    cardElement.classList.toggle("card-style");
}